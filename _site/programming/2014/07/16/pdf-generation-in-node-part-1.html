<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>PDF Generation in Node - Part 1 &#8211; Secret Robot Internet</title>
<meta name="description" content="The Chaotic Ramblings of a Madman.">
<meta name="keywords" content="">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://chaosevoker.github.io/images/abstract-10.jpg">

<meta name="twitter:title" content="PDF Generation in Node - Part 1">
<meta name="twitter:description" content="The Chaotic Ramblings of a Madman.">
<meta name="twitter:creator" content="@ChaosEvoker">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="PDF Generation in Node - Part 1">
<meta property="og:description" content="The Chaotic Ramblings of a Madman.">
<meta property="og:url" content="http://chaosevoker.github.io/programming/2014/07/16/pdf-generation-in-node-part-1.html">
<meta property="og:site_name" content="Secret Robot Internet">





<link rel="canonical" href="http://chaosevoker.github.io/programming/2014/07/16/pdf-generation-in-node-part-1.html">
<link href="http://chaosevoker.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Secret Robot Internet Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://chaosevoker.github.io/assets/css/main.min.css">
<!-- Webfonts -->
<link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://chaosevoker.github.io/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://chaosevoker.github.io/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://chaosevoker.github.io/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://chaosevoker.github.io/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://chaosevoker.github.io/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://chaosevoker.github.io/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://chaosevoker.github.io/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="http://chaosevoker.github.io">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="http://chaosevoker.github.io/images/avatar.jpg" alt="Phillip Sipe photo" class="author-photo">
					<h4>Phillip Sipe</h4>
					<p>A Javascript Web Developer who enjoys being a huge nerd.</p>
				</li>
				<li><a href="http://chaosevoker.github.io/about/">Learn More</a></li>
				<li>
					<a href="mailto:chaosevoker@gmail.com"><i class="fa fa-envelope"></i> Email</a>
				</li>
				<li>
					<a href="http://twitter.com/ChaosEvoker"><i class="fa fa-twitter"></i> Twitter</a>
				</li>
				
				
				
				<li>
					<a href="http://github.com/ChaosEvoker"><i class="fa fa-github"></i> GitHub</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="http://chaosevoker.github.io/posts/">All Posts</a></li>
				<li><a href="http://chaosevoker.github.io/tags/">All Tags</a></li>
			</ul>
		</li>
		
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->



<div class="entry-header">
  <div class="image-credit">Image source: <a href="http://www.dargadgetz.com/ios-7-abstract-wallpaper-pack-for-iphone-5-and-ipod-touch-retina/">dargadgetz</a></div><!-- /.image-credit -->
  <div class="entry-image">
    <img src="http://chaosevoker.github.io/images/abstract-10.jpg" alt="PDF Generation in Node - Part 1">
  </div><!-- /.entry-image -->
</div><!-- /.entry-header -->


<div id="main" role="main">
  <article class="hentry">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title"><a href="http://chaosevoker.github.io/programming/2014/07/16/pdf-generation-in-node-part-1.html" rel="bookmark" title="PDF Generation in Node - Part 1">PDF Generation in Node - Part 1</a></h1>
        
        <h2>July 16, 2014</h2>
        
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
      <p>PDF Generation in Node - Part 1: Directly Drawing the PDF</p>

<p>I’ve recently been neck-deep in refactoring a project. I just got to the automated report generation code in the project, and it made me all nostalgic. That’s the feeling where you need to suddenly run to the bathroom right?</p>

<p>I’ve tried quite a variety of strategies in creating PDF reports on a Node server automatically. Each has a set of strengths and weaknesses, and there isn’t a single perfect solution. I’ve broken down the types of solutions into 3 distinct categories. I will be using a particular technology for each of the examples, but you should know that each category has a variety of technologies/libraries/etc. within it. There are subtleties between each of them, but for now I am just going to go over the larger categories and the major differences between them. Because everyone likes it when stuff is broken down into numbers, I’ll also be rating the categories on a scale of 1 to 5 on the following fields:</p>
<ol>
    <li><strong>Power</strong> - The level of control you have over what the resulting PDF looks like</li>
    <li><strong>Efficiency</strong> - How many resources the strategy consumes</li>
    <li><strong>Ease of Use</strong> - How easy the solution is to implement</li>
    <li><strong>Flexibility</strong> - How easy it is to alter the appearance of the PDF (for example due to a marketing redesign)</li>
</ol>

<p>With that, let’s get to the categories!</p>

<h2 id="draw-the-pdf-directly">Draw the PDF Directly</h2>

<p>For the examples in this section I’ll be using <a href="http://pdfkit.org/">PDFKit</a>.</p>

<p>Drawing the PDF is by far the most powerful solution. However, with great power comes great amounts of code:</p>

<div class="highlight"><pre><code class="js">    <span class="kd">var</span> <span class="nx">PDFDocument</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;pdfkit&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nb">document</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PDFDocument</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">font</span><span class="p">(</span><span class="s1">&#39;Times-Roman&#39;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">fontSize</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s1">&#39;Hello World!&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
</code></pre></div>

<p>Now obviously, this is not a “great amount” of code. Heck, I sort of made it seem larger with all those extra new lines and indentations!</p>

<p>If you program with a library like this for any significant amount of time, you’ll likely end up writing in a similar way. PDFKit’s API is very chainable, which significantly cuts down on lines of code, but does result in some very long lines. Styling your code like this will really help future readability.</p>

<p>Let’s add a bit of complexity:</p>

<div class="highlight"><pre><code class="js"><span class="nb">document</span><span class="p">.</span><span class="nx">rect</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">);</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">font</span><span class="p">(</span><span class="s1">&#39;Times-Roman&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">fontSize</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">fillColor</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s1">&#39;White text on a gray background!&#39;</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">60</span><span class="p">);</span>
</code></pre></div>

<p>This added complexity is making another potential problem with direct drawing apparent. There are a lot of magic numbers. It can be very hard to keep all of your hardcoded numbers organized. It is possible to keep everything together without using magic numbers, but it is a time consuming development effort.</p>

<p>The real drawback of this solution, however, is the amount of effort it takes to change the document’s appearance. In my case, marketing came back with a design once that they wanted to try for a report we were generating. It was so different, we were forced to tell them that we would be (more or less) starting over! Given that the visual design of things often changes at a rapid pace, this is obviously a large drawback.</p>

<p>Now, this overview has been pretty negative so far. I won’t lie and say that this is my preferred solution. It isn’t. But, this solution is extremely powerful. If you want to draw some crazy mathematically calculated fractal and put it in a PDF, you can do that without jumping through hoops. This solution trades convenience for power, and it has power in spades.</p>

<p>The other benefit to this solution that will become more apparent when we look at the next solution, is resource consumption. This is fast and disk efficient, and you are unlikely to run into any size barriers using this method.</p>

<p><strong>Final Rating</strong></p>
<ul>
    <li><strong>Power</strong> - 5</li>
    <li><strong>Efficiency</strong> - 5</li>
    <li><strong>Ease of Use</strong> - 2</li>
    <li><strong>Flexibility</strong> - 1</li>
</ul>

<p>Ultimately, drawing the PDF directly is a solution of extremes. If you need large amounts of precise control over the document’s appearance and you need it to be efficiently sized, then directly drawing it will serve you well. However, it will take a much greater effort to develop and change the PDF (relative to other solutions).</p>

<p>So that took up way more text than I expected when I started writing this post. So, I’m going to break it up into several posts. Next time we will cover the world of PDF generation through headless browsers!</p>

      <footer class="entry-meta">
        <span class="entry-tags"></span>
        <span><a href="http://chaosevoker.github.io/programming/2014/07/16/pdf-generation-in-node-part-1.html" rel="bookmark" title="PDF Generation in Node - Part 1">PDF Generation in Node - Part 1</a> was published on <span class="entry-date date published updated"><time datetime="2014-07-16T10:10:49-05:00">July 16, 2014</time></span></span>
        
        <span class="author vcard"><span class="fn"><a href="http://chaosevoker.github.io/about/" title="About Phillip Sipe">Phillip Sipe</a></span></span>
        
      </footer>
    </div><!-- /.entry-content -->
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
    
    <div class="read-more">
      
        <div class="read-more-header">
          <a href="http://chaosevoker.github.io" class="read-more-btn">Read More</a>
        </div><!-- /.read-more-header -->
        <div class="read-more-content">
          <h3><a href="http://chaosevoker.github.io/update/2014/07/16/ramblings-of-a-chaotic-madman.html" title="Ramblings of a Chaotic Madman">Ramblings of a Chaotic Madman</a></h3>
          <p>Ramblings of a Chaotic MadmanHello to all of you who stumbled here by mistake. This is the place where I talk about technology and stuff....&hellip; <a href="http://chaosevoker.github.io/update/2014/07/16/ramblings-of-a-chaotic-madman.html">Continue reading</a></p>
        </div><!-- /.read-more-content -->
      
      <div class="read-more-list">
        
      </div><!-- /.read-more-list -->
      
    </div><!-- /.read-more -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2014 Phillip Sipe. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/hpstr/">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'chaosevoker'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://chaosevoker.github.io/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://chaosevoker.github.io/assets/js/scripts.min.js"></script>

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'shortname'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</body>
</html>
