<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>PDF Generation in Node - Part 2 &#8211; Secret Robot Internet</title>
<meta name="description" content="The Chaotic Ramblings of a Madman.">
<meta name="keywords" content="">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://chaosevoker.github.io/images/abstract-10.jpg">

<meta name="twitter:title" content="PDF Generation in Node - Part 2">
<meta name="twitter:description" content="The Chaotic Ramblings of a Madman.">
<meta name="twitter:creator" content="@ChaosEvoker">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="PDF Generation in Node - Part 2">
<meta property="og:description" content="The Chaotic Ramblings of a Madman.">
<meta property="og:url" content="http://chaosevoker.github.io/programming/2014/07/16/pdf-generation-in-node-part-2.html">
<meta property="og:site_name" content="Secret Robot Internet">





<link rel="canonical" href="http://chaosevoker.github.io/programming/2014/07/16/pdf-generation-in-node-part-2.html">
<link href="http://chaosevoker.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Secret Robot Internet Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://chaosevoker.github.io/assets/css/main.min.css">
<!-- Webfonts -->
<link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://chaosevoker.github.io/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://chaosevoker.github.io/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://chaosevoker.github.io/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://chaosevoker.github.io/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://chaosevoker.github.io/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://chaosevoker.github.io/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://chaosevoker.github.io/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="http://chaosevoker.github.io">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="http://chaosevoker.github.io/images/avatar.jpg" alt="Phillip Sipe photo" class="author-photo">
					<h4>Phillip Sipe</h4>
					<p>A Javascript Web Developer who enjoys being a huge nerd.</p>
				</li>
				<li><a href="http://chaosevoker.github.io/about/">Learn More</a></li>
				<li>
					<a href="mailto:chaosevoker@gmail.com"><i class="fa fa-envelope"></i> Email</a>
				</li>
				<li>
					<a href="http://twitter.com/ChaosEvoker"><i class="fa fa-twitter"></i> Twitter</a>
				</li>
				
				
				
				<li>
					<a href="http://github.com/ChaosEvoker"><i class="fa fa-github"></i> GitHub</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="http://chaosevoker.github.io/posts/">All Posts</a></li>
				<li><a href="http://chaosevoker.github.io/tags/">All Tags</a></li>
			</ul>
		</li>
		
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->



<div class="entry-header">
  <div class="image-credit">Image source: <a href="http://www.dargadgetz.com/ios-7-abstract-wallpaper-pack-for-iphone-5-and-ipod-touch-retina/">dargadgetz</a></div><!-- /.image-credit -->
  <div class="entry-image">
    <img src="http://chaosevoker.github.io/images/abstract-10.jpg" alt="PDF Generation in Node - Part 2">
  </div><!-- /.entry-image -->
</div><!-- /.entry-header -->


<div id="main" role="main">
  <article class="hentry">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title"><a href="http://chaosevoker.github.io/programming/2014/07/16/pdf-generation-in-node-part-2.html" rel="bookmark" title="PDF Generation in Node - Part 2">PDF Generation in Node - Part 2</a></h1>
        
        <h2>July 16, 2014</h2>
        
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
      <p>PDF Generation in Node - Part 2: Rendering the PDF with a Headless Browser</p>

<p>If you missed part 1 of this series, you can find it <a href="http://chaosevoker.github.io/programming/2014/07/16/pdf-generation-in-node-part-1.html">here</a>.</p>

<p>As a reminder, here is how I will ultimately rate the solutions (on a scale of 1 to 5):</p>
<ol>
    <li><strong>Power</strong> - The level of control you have over what the resulting PDF looks like</li>
    <li><strong>Efficiency</strong> - How many resources the strategy consumes</li>
    <li><strong>Ease of Use</strong> - How easy the solution is to implement</li>
    <li><strong>Flexibility</strong> - How easy it is to alter the appearance of the PDF (for example due to a marketing redesign)</li>
</ol>

<p>Alright, no one like recaps right? Enough of that, let’s get to…</p>

<h2 id="using-a-headless-browser">Using a Headless Browser</h2>

<p>For the examples in this discussion I will be using <a href="https://github.com/TJkrusinski/NodePDF">NodePDF</a>. This node module uses <a href="http://phantomjs.org/">PhantomJS</a> in the background. It is very possible to just use Phantom directly. However, the syntax for doing so is a lot harder to grok at a first look. So, I’m going to use NodePDF to keep things simple and clear.</p>

<p>For those who may not be familiar with the term, headless browsers are pieces of software that behave like a web browser, but have no GUI (this is why they are “headless”). They have whole suites of functions that allow you to interact with a webpage programmatically. NodePDF will abstract most of the handling of our headless browser away from us, so that we can focus on the PDF, but it’ll be important to understand the concept of headless browsing when discussing the strengths and weaknesses of this approach.</p>

<p>So, clearly drawing the PDF directly is a powerful, but low-level solution to PDF generation. What if we wanted something that had less maintenance and code overhead? We’d also prefer to have a solution which utilizes web technologies that we are familiar with. Fortunately, headless browsers provide that solution. We can point a headless browser at a web page and then render it as a PDF file. This allows us to use HTML and CSS to stylize a document and then simply convert it to a PDF all automatically. Since we are using HTML, this also lets us use whatever templating engine we’d like (e.g. Jade) to make our lives easier as well.</p>

<p>Here’s how to generate a PDF using NodePDF and PhantomJS:</p>

<div class="highlight"><pre><code class="js"><span class="kd">var</span> <span class="nx">NodePDF</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;nodepdf&#39;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nb">document</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">NodePDF</span><span class="p">(</span><span class="s1">&#39;/path/to/HTML/file.html&#39;</span><span class="p">,</span> <span class="s1">&#39;/path/to/output/PDF/file.pdf&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">viewportSize</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">width</span><span class="o">:</span> <span class="mi">1440</span><span class="p">,</span>
        <span class="nx">height</span><span class="o">:</span> <span class="mi">900</span>
    <span class="p">},</span>
    <span class="nx">paperSize</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">pageFormat</span><span class="o">:</span> <span class="s1">&#39;Letter&#39;</span><span class="p">,</span>
        <span class="nx">margin</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">top</span><span class="o">:</span> <span class="s1">&#39;1.5in&#39;</span><span class="p">,</span>
            <span class="nx">left</span><span class="o">:</span> <span class="s1">&#39;1in&#39;</span><span class="p">,</span>
            <span class="nx">right</span><span class="o">:</span> <span class="s1">&#39;1in&#39;</span><span class="p">,</span>
            <span class="nx">bottom</span><span class="o">:</span> <span class="s1">&#39;1in&#39;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">zoomFactor</span><span class="o">:</span> <span class="mf">1.0</span>
<span class="p">});</span>

<span class="nb">document</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
<span class="p">});</span>

<span class="nb">document</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">path_to_pdf</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">path_to_pdf</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>

<p>You may notice that this is a similar syntax to Node’s HTTP and child process modules. There are also events for the stdout and stderr streams. The options available are the options that PhantomJS provided for its render function, and there are many more than are shown here. The options are fairly extensive and cover a wide range of things. For this example, I’ve just used a relatively simple baseline.</p>

<p>Fundamentally, we are opening an HTML file in a browser, taking a picture of it, and saving that picture as a PDF. Simple, clean, and easy. However, this solution comes with a significant drawback that may not be clear at first.</p>

<p>When we put a line of text into the PDF document using the direct drawing technique, raw text was placed into the document. But, if we did the same thing with the headless browser technique, then we are putting a <em>picture of text</em> into the document. This is a massive jump in space demands. For many applications, this won’t matter. For a single page PDF the differences will likely not be as important. However, for the application I was working on, the sizes of the documents could range from a couple of pages to hundreds of pages. Clients wanted their reports delivered by email, but some of the larger reports exceeded the attachment limit! I attempted a variety of hack-like workarounds, but I couldn’t bring the size down enough, and this solution proved unworkable as a result.</p>

<p>So, this solution had a fatal weakness for me, but it could very easily be just what you are looking for. Here’s how this solution rates:</p>

<ol>
    <li><strong>Power</strong> - 4</li>
    <li><strong>Efficiency</strong> - 1</li>
    <li><strong>Ease of Use</strong> - 4</li>
    <li><strong>Flexibility</strong> - 5</li>
</ol>

<p>You don’t lose too much power with this solution, as you can do a lot with what is possible in modern browsers. You gain a ton in how easy this solution is to implement. It doesn’t get much easier than this, though there are still a couple of gotchas with using Phantom that can provide a few frustrating moments. Howeverm the real loss here is in the size of the document. These PDFs will be relatively enormous, which can make it unuseable for certain applications (like mine).</p>

<p>I was not ready to give up on using simple HTML templates, however. Designing and tweaking those templates had felt like heaven compared to tweaking the direct drawing technique. Undaunted, I continued searching for an alternative. I delved into the depths of Google until I found a new path. A third solution…</p>

<p>That I will discuss next time!</p>

      <footer class="entry-meta">
        <span class="entry-tags"></span>
        <span><a href="http://chaosevoker.github.io/programming/2014/07/16/pdf-generation-in-node-part-2.html" rel="bookmark" title="PDF Generation in Node - Part 2">PDF Generation in Node - Part 2</a> was published on <span class="entry-date date published updated"><time datetime="2014-07-16T10:10:49-05:00">July 16, 2014</time></span></span>
        
        <span class="author vcard"><span class="fn"><a href="http://chaosevoker.github.io/about/" title="About Phillip Sipe">Phillip Sipe</a></span></span>
        
      </footer>
    </div><!-- /.entry-content -->
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
    
    <div class="read-more">
      
        <div class="read-more-header">
          <a href="http://chaosevoker.github.io/programming/2014/07/16/pdf-generation-in-node-part-1.html" class="read-more-btn">Read More</a>
        </div><!-- /.read-more-header -->
        <div class="read-more-content">
          <h3><a href="http://chaosevoker.github.io/update/2014/07/16/ramblings-of-a-chaotic-madman.html" title="Ramblings of a Chaotic Madman">Ramblings of a Chaotic Madman</a></h3>
          <p>Ramblings of a Chaotic MadmanHello to all of you who stumbled here by mistake. This is the place where I talk about technology and stuff....&hellip; <a href="http://chaosevoker.github.io/update/2014/07/16/ramblings-of-a-chaotic-madman.html">Continue reading</a></p>
        </div><!-- /.read-more-content -->
      
      <div class="read-more-list">
        
          <div class="list-item">
            <h4><a href="http://chaosevoker.github.io/programming/2014/07/16/pdf-generation-in-node-part-1.html" title="PDF Generation in Node - Part 1">PDF Generation in Node - Part 1</a></h4>
            <span>Published on July 16, 2014</span>
          </div><!-- /.list-item -->
        
      </div><!-- /.read-more-list -->
      
    </div><!-- /.read-more -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2014 Phillip Sipe. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/hpstr/">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'chaosevoker'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://chaosevoker.github.io/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://chaosevoker.github.io/assets/js/scripts.min.js"></script>

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'shortname'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</body>
</html>
